[00:06] *** librasteve_ left
[00:08] *** arkiuat joined
[00:12] *** arkiuat left
[00:24] <disbot7> <antononcube> Has 24th Day been claimed?

[00:25] <lizmat> not to my knowledge....  fwiw, I have a backup post I could put in there, but would be glad to leave it to someone else  :-)

[00:35] *** arkiuat joined
[00:40] *** arkiuat left
[00:43] <tbrowder> if interested i have a  snow flake in PostScript code which can be converted to other formats.

[00:44] <disbot7> <antononcube> SVG?

[00:45] <tbrowder> i‚Äôm sure ChatGPT can do it.

[00:47] <tbrowder> i created it many years ago following the examples in one of Adobe‚Äôs printed books which i still have,

[00:49] <tbrowder> the book described in clear Adobe style all the PS functions with examples

[00:50] *** arkiuat joined
[01:24] *** arkiuat left
[01:27] *** arkiuat joined
[01:38] *** arkiuat left
[01:44] *** arkiuat joined
[02:34] *** hulk joined
[02:36] *** kylese left
[03:15] *** hulk left
[03:15] *** kylese joined
[03:37] *** sibl joined
[04:18] *** lichtkind_ joined
[04:21] *** lichtkind left
[04:25] *** Aedil joined
[06:55] *** phogg` joined
[06:55] *** phogg left
[06:56] *** arkiuat left
[07:08] *** arkiuat joined
[07:14] *** arkiuat left
[07:30] *** sibl left
[07:35] *** sibl joined
[07:44] *** arkiuat joined
[07:50] *** arkiuat left
[07:52] *** sibl left
[07:52] *** sibl joined
[08:01] *** arkiuat joined
[08:06] *** arkiuat left
[08:06] <disbot7> <simon_sibl> I just did a quick benchmark for an exercise I made with colleague for interview, he made it in Python and I made it in Raku, the speed difference is huge and I would like to know if thats expected or if my code is simply much less optimized: https://termbin.com/mgru

[08:08] <disbot7> <simon_sibl> also the memory usage seems to be huge for Raku compared to Python

[08:28] *** Sgeo left
[08:31] <ab5tract> vushu: amazing!! Great to see you here again btw

[08:33] *** arkiuat joined
[08:34] <ab5tract> tbrowder: any chance that it is a dynamically generated snowflake? It would be amazing to have a .eps file that resolves to a new snowflake every time it is embedded :)

[08:39] *** arkiuat left
[08:43] *** arkiuat joined
[08:47] *** arkiuat left
[09:06] *** sibl left
[09:14] *** donaldh joined
[09:16] *** arkiuat joined
[09:16] *** librasteve_ joined
[09:21] *** arkiuat left
[09:50] *** arkiuat joined
[09:55] *** arkiuat left
[10:27] *** arkiuat joined
[10:33] *** arkiuat left
[10:42] *** tejr left
[10:54] <tbrowder> hm, probably so, i‚Äôm slammed right now but i could gist it here later. i‚Äôm getting ChatGPT to help organize my PS file collection and it will eventually be on my public github repo

[10:55] *** arkiuat joined
[10:56] <tbrowder> it‚Äôs created so the rotation angle and diam can be randomized.

[10:56] <lizmat> simon_sibl OOC< how does it time with the printf() replaced by just interpolation, so: say $j<title> (prio $j<priority>): Submits at $j<submit>, starts at $time, ends at $ends. Wait time = $wait."

[10:57] <lizmat> rather:   say "$j<title> (prio $j<priority>): Submits at $j<submit>, starts at $time, ends at $ends. Wait time = $wait."

[10:57] <lizmat> printf is notoriously slow because it runs a grammar *every time* it is called

[11:00] <lizmat> also, it feels that the jobs has should be a proper class to reduce the number of hash lookups

[11:00] *** arkiuat left
[11:00] <lizmat> also, maybe https://raku.land/zef:lizmat/Concurrent::PriorityQueue  ?   :-)

[11:05] *** tejr joined
[11:10] *** ShimmerFairy left
[11:15] *** arkiuat joined
[11:21] *** arkiuat left
[11:33] *** arkiuat joined
[11:39] <Geth> ¬¶ advent/main: 2d07fe7b24 | (Elizabeth Mattijsen)++ (committed using GitHub Web editor) | raku-advent-2025/authors.md

[11:39] <Geth> ¬¶ advent/main: Update, slot 24 still open!

[11:39] <Geth> ¬¶ advent/main: review: https://github.com/Raku/advent/commit/2d07fe7b24

[11:40] <ab5tract> .vushu: next step may just be to add texture rotation based on the wind :)

[11:42] *** arkiuat left
[11:49] *** arkiuat joined
[11:49] <disbot7> <.vushu> @ab5tract maybe you can finish your up your project üòÑ

[11:50] <disbot7> <.vushu> @grondilu thanks for the fix --force-install isn't necessary I just didn't bother uninstalling before installing.

[11:53] *** arkiuat left
[12:04] *** librasteve_ left
[12:20] *** arkiuat joined
[12:20] <Voldenet> simon_sibl: raku code allocates gigantic hash for every single element, so it's slow and memory hungry as expected

[12:21] <Voldenet> I mean, the hash is probably bigger than things it contains

[12:24] *** arkiuat left
[12:25] <Voldenet> `priority_stats[priority][0]` vs `%result{$j<priority>}`

[12:25] <Voldenet> on top of it, priority_stats uses int-based dictionary, hashes in raku allow only strings

[12:29] <Voldenet> that python is just a lot stricter about performance, raku code is stricter about readability

[12:29] <Voldenet> `priority_stats[priority][1] += 1` yeah totally :)

[12:30] <Voldenet> `%result{$j<priority>} += $wait;` uses <op>= metaop which adds some overhead too

[12:32] *** arkiuat joined
[12:33] <Voldenet> also, I'm not sure why none of these code snippets simply use classes for jobs if performance is important

[12:35] <Voldenet> classes are always huge win both in readability and performance, because they give code optimization opportunities

[12:46] *** arkiuat left
[12:53] <Voldenet> btw, I've looked at benchmark and it's ridiculous ‚Äì you're comparing runtime of processes that take 5ms

[12:53] <ab5tract> Great points, but I want to clarify that object hashes do exist

[12:53] <Voldenet> using that methodology can lead to enlightening thought that js is faster than rust :>

[12:53] <Voldenet> since compilation would take time

[12:58] <Voldenet> ab5tract: by "object hashes" you mean hashes that contain object's data or hashes that are shaped like an array by some optimization?

[13:00] <ab5tract> m: my %h is Hash[Int,Int]; dd %h{121} = 42

[13:00] <camelia> rakudo-moar f95aefad9: OUTPUT: ¬´Int  = 42‚ê§¬ª

[13:01] <ab5tract> m: my %h is Hash[Int,Int]; dd %h{‚Äú121‚Äù} = 42

[13:01] <camelia> rakudo-moar f95aefad9: OUTPUT: ¬´Type check failed in binding to parameter 'key'; expected Int but got Str ("121")‚ê§  in block <unit> at <tmp> line 1‚ê§‚ê§¬ª

[13:01] <disbot7> <antononcube> @simon_sibl Well, thanks for putting the benchmark together. I hear that Raku can do it (or some of it)  faster, which ‚Äî hopefully ‚Äî means that someone can re-write it.

[13:02] *** ShimmerFairy joined
[13:04] <disbot7> <antononcube> @librasteve Is there a performance page in raku.org ? Some of the points @Voldenet made above might be good to be there‚Ä¶

[13:06] *** arkiuat joined
[13:09] <Voldenet> ab5tract: is that implemented on nqp level? Because if not it wouldn't beat python's dictobject (which uses C)

[13:09] <Voldenet> in nqp I can only find string-based hash

[13:11] *** arkiuat left
[13:14] <lizmat> there is only a string based hash

[13:15] <lizmat> all other hash types, such as object hashes, under the hood revert to a string

[13:15] <lizmat> a hash with keys limited to Int, is basically an object hash with a constraint on the key

[13:16] <lizmat> so slower

[13:20] <Voldenet> though in theory it is possible to implement hashtable in pure raku

[13:21] <Voldenet> and in theory it doesn't have to be slower than C

[13:24] <lizmat> my reference to "so slower" is about the current implementation  :-)

[13:24] *** arkiuat joined
[13:25] <lizmat> now if objects of value types would share their unique values, we could use the object id as a key in the hash

[13:25] <lizmat> but unfortunately, they don't

[13:26] <Voldenet> you can expect boring equality contract to be implemented

[13:26] <Voldenet> hashCode + equals

[13:27] <disbot7> <librasteve> @antononcube there is no performance page on raku.org --- the goal of raku.org is to convert new potential raku users, so doesn't really belong there imo --- I would support a Performance page in the docs (https://docs.raku.org/introduction) with an emphasis on how to avoid the pitfalls listed above.

[13:27] <Voldenet> I remember TypedHash using .WHICH which usually requires some serialized string, I'm not sure if that's still valid

[13:28] <disbot7> <librasteve> oh - there is one already => https://docs.raku.org/language/performance#First,_profile_your_code

[13:29] <disbot7> <librasteve> so - suggest we gather anything missing and apply as a PR to that docs page

[13:29] <disbot7> <librasteve> @simon_sibl - note the performance page in the docs ^^

[13:29] *** arkiuat left
[13:29] <lizmat> Voldenet: that's how object hashes work

[13:29] <disbot7> <librasteve> may help to improve, I have used the profiler from time to time

[13:30] *** librasteve_ joined
[13:30] <Voldenet> ‚Ä¶wait, so does that mean that typed int hash is slower than regular hash?

[13:30] <Voldenet> m: my %h is Hash[Int,Int]; for ^100 { %h{$_} = $_ + 2; }; say now - BEGIN now

[13:30] <camelia> rakudo-moar f95aefad9: OUTPUT: ¬´0.0347615‚ê§¬ª

[13:31] <Voldenet> m: my %h is Hash; for ^100 { %h{$_} = $_ + 2; }; say now - BEGIN now

[13:31] <camelia> rakudo-moar f95aefad9: OUTPUT: ¬´0.015954565‚ê§¬ª

[13:31] <lizmat> yup

[13:31] <lizmat> I once wrote https://raku.land/zef:lizmat/Hash::int

[13:31] <Voldenet> yeah, I remember, it was wildly faster because of nqp ops

[13:32] <lizmat> but I'm afraid the performance advantage has largely evaporated after the new dispatch

[13:35] <Voldenet> I'm starting to wonder if `role Equatable` and regular list-based hashtable wouldn't be fast enough to beat string-based Hash for ints

[13:38] <lizmat> I vaguely remember trying that...   I think as soon as you hit 10+ keys, hashes were actually faster

[13:39] <disbot7> <antononcube> @librasteve The profiler has been pretty useless for me, lately.

[13:39] <lizmat> the overhead of the MoarVM runloop quickly kicks in compared to C code that goes to the metal

[13:39] *** arkiuat joined
[13:40] <Voldenet> eh so the only "sane" option would be having actual nqp objecthash

[13:41] <Voldenet> or nativecall one

[13:41] <lizmat> well, the expensive thing is still the .WHICH calculation

[13:41] <lizmat> which is HLL

[13:41] <Voldenet> .WHICH is actually not HASHCODE

[13:42] <Voldenet> it can't has collisions, hashcode can - this is actually big requirement for performance here

[13:42] <Voldenet> s/has/have/

[13:43] <lizmat> well, a collision in .WHICH just means that two objects are going to be considered identical, even if they maybe aren't because of a deficiency in the .WHICH creation

[13:44] <Voldenet> and that contract is insane for hashcode imo, this can never work well

[13:44] <Voldenet> erm, for typed hash

[13:45] *** arkiuat left
[13:49] <Voldenet> WHICH basically does string serialization, so resulting strings has to be bigger and more inefficient

[13:50] <Voldenet> it could be faster in case where object would do a lot of dereferencing to get into data and all those pointers are non-cached anyhow

[13:51] <Voldenet> though I wouldn't bet on it being faster and smaller

[13:54] *** arkiuat joined
[13:55] <Voldenet> hm, I'm going to test my assumptions and see if I can make it faster Hash using raku only

[13:55] <lizmat> yeah: I've done a lot of (perhaps premature) optimization in that area in the core

[13:55] <lizmat> ++Voldenet    looking forward to the results, even if they turn out to be negative!

[13:56] <Voldenet> if they turn out negative, I see if I can implement nqp::hashcode or something to make it fast enough

[13:58] <Voldenet> I could also use tiny wrapper over std::unordered_map

[13:58] <Voldenet> I'm betting I can beat hashes if I punch the problem with enough C/C++

[13:59] *** arkiuat left
[14:24] *** arkiuat joined
[14:25] <disbot7> <antononcube> @lizmat I nominate the packages (1) "Math::NumberTheory" and (2) "LLM::Graph".

[14:26] <disbot7> <antononcube> I am wanted to nominate "App::samaki" -- I really like the described idea and functionalities -- but I cannot install it.

[14:27] <disbot7> <antononcube> I assume "App::samaki" would be nominated by someone who has already installed and used it.

[14:31] <lizmat> antononcube thanks, added

[14:31] *** arkiuat left
[14:32] *** arkiuat joined
[14:37] *** arkiuat left
[14:41] *** arkiuat joined
[14:45] *** arkiuat left
[15:04] <disbot7> <antononcube> @lizmat and @librasteve I am going to propose a few posts: 1. Labyrinth making (with graphs) 2. LLM generated images over code of this year's advent posts 3. Who has the better highlighter (again)

[15:05] <disbot7> <antononcube> They are given in preference order, but I am open to suggestions.

[15:07] <disbot7> <antononcube> The 2nd one would have been "easy" if all of the posts had links to Markdown sources. (I know it is not how many of were written.)

[15:07] *** arkiuat joined
[15:11] <disbot7> <jubilatious1_98524> @lizmat Raku doesn't have an Int -based hash? (not that I would be able to write one... ).

[15:12] <lizmat> https://raku.land/zef:lizmat/Hash::int is the closest thing

[15:12] *** arkiuat left
[15:12] <disbot7> <jubilatious1_98524> @lizmat Cool, thanks!

[15:15] <disbot7> <jubilatious1_98524> Ruminating... Would a 1-indexed Int-based hash make sense. Basically that would reserve the 0-index to signify Empty hash. Any hash experts around?

[15:33] <disbot7> <aruniecrisps> I do wonder if it wouldn't be useful to have a changemark function that allows you to change the mark on a character

[15:37] <lizmat> please note that 6.e already provides a .nomark method

[15:38] <lizmat> m: use v6.e.PREVIEW; say "√©l√®ve".nomark;

[15:38] <camelia> rakudo-moar f95aefad9: OUTPUT: ¬´eleve‚ê§¬ª

[15:41] *** arkiuat joined
[15:47] <disbot7> <aruniecrisps> Do you think I could use that to make the changemark or samebase function?

[15:49] *** arkiuat left
[15:50] <lizmat> I'd say, it's a start?

[15:50] *** phogg` is now known as phogg

[15:50] <lizmat> m: use v6.e.PREVIEW; .say for "√©l√®ve".comb>>.nomark

[15:50] <camelia> rakudo-moar f95aefad9: OUTPUT: ¬´e‚ê§l‚ê§e‚ê§v‚ê§e‚ê§¬ª

[15:57] <lizmat> antononcube does that mean I'm off the hook for tomorrow ?   If so, thanks!  :-)

[15:58] <lizmat> the overview is becoming slightly monstruous in size  :-)

[16:18] *** arkiuat joined
[16:23] *** arkiuat left
[16:26] <disbot7> <antononcube> @lizmat Yes. I will finish 24th Day within few hours.

[16:27] <lizmat> antononcube  great, means I have more time for the review!

[16:37] *** arkiuat joined
[17:06] <tbrowder> antononcube: i don‚Äôt understand exactly how you define a ‚Äúhappy number‚Äù. could you explain a simple one for a math dummy? thnx

[17:10] <tbrowder> ok, i see it now‚Ä¶

[17:17] <tbrowder> i didn‚Äôt grok where the first (e.g) starting number came from until i stared at it a while‚Äîduh

[17:24] *** librasteve_ left
[17:46] <Geth> ¬¶ Papers/main: 50323551c2 | (Elizabeth Mattijsen)++ | minutes/20251220.md

[17:46] <Geth> ¬¶ Papers/main: Minutes of the 20 Dec meeting

[17:46] <Geth> ¬¶ Papers/main: review: https://github.com/Raku-Steering-Council/Papers/commit/50323551c2

[17:48] <Geth> ¬¶ Papers/main: b60b6dc8e2 | (Elizabeth Mattijsen)++ | announcements/20251223.md

[17:48] <Geth> ¬¶ Papers/main: Announce Stefan Seifert stepping down from RSC and CAT

[17:48] <Geth> ¬¶ Papers/main: review: https://github.com/Raku-Steering-Council/Papers/commit/b60b6dc8e2

[18:04] <disbot7> <antononcube> @tbrowder " i didn‚Äôt grok where the first [...]" -- common experience when one reads mathematical papers... üòé

[18:06] <lizmat> https://github.com/Raku/problem-solving/issues/508

[18:06] <lizmat> Make $ sigil optional for scalar variables in 6.e

[18:13] *** arkiuat left
[18:16] *** arkiuat joined
[18:21] *** arkiuat left
[18:31] *** Pixi left
[18:39] *** Pixi joined
[18:50] *** arkiuat joined
[18:55] *** arkiuat left
[19:11] <Voldenet> lizmat: so, trivial linear probing hashtable beats 

[19:11] <Voldenet> erm, I was about to finish the message

[19:11] <Voldenet> trivial linear probing hashtable beats Hash[Str, Foo] for very large values

[19:13] <Voldenet> I had to add "trivial" because the implementation doesn't use any particular tricks (maybe apart from not handling the fact where linear probing fails)  https://0x0.st/Pzjf.raku

[19:14] <Voldenet> output on my box is `LinearHashMap[262144]  ADD 1.205950509 GET 0.53381213 MEM 601 // Hash[Str,Foo][262144]  ADD 1.748837529 GET 0.720105764 MEM 15479`

[19:16] <Voldenet> of course, it only works for very specific conditions and removal is going to be extremely poor with collisions

[19:16] <lizmat> actually...   maybe the typecache can be abused for a quick integer lookup

[19:17] <lizmat> an nqp::istype under the hood, is nothing more than an integer match on an integer array, containing the object IDs of all classes / roles involved

[19:19] <lizmat> I wonder whether it would make sense to create an nqp op for this kind of fast lookup, rather than abusing the typecache for this

[19:19] <lizmat> timo ^^  does that make sense ?

[19:19] <lizmat> deletion could be just zeroing out the entry

[19:20] <Voldenet> if hash could be used directly for HASHCODE it would be major win, but then you have to deal with EQUALS as well sadly

[19:22] <Voldenet> nqp::atkey(%h<>, "foo") and nqp::atkey(%<>, "colliding-foo") work in string case, because atkey handles it

[19:23] <lizmat> not sure what you mean

[19:23] <Voldenet> nevermind, I re-read that

[19:23] *** arkiuat joined
[19:24] <Voldenet> I was too deep in the problem and thought about nqp::atkey_numeric which is wrong in the context

[19:28] *** arkiuat left
[19:29] <lizmat> I was thinking about an nqp::isin_i(int $needle, int @haystack) returning the index where needle was found, or nqp::elems(@haystack) if not

[19:32] <disbot7> <aruniecrisps> lizmat: I have a counterargument to the no sigils default: the dollar sign sigil doesn't seem to be a deterrent for PHP

[19:33] <lizmat> well... perhaps: but please leave these comments in the issue (if you can :-)

[19:34] <Voldenet> I have tried doing `role HashMap[$cap] { ‚Ä¶ }` but native arrays are slower

[19:35] <Voldenet> ‚Ä¶?!

[19:35] <lizmat> native arrays can be slower if they need repetitive HLLizing of value

[19:35] <lizmat> s

[19:35] <Voldenet> Ah: https://0x0.st/PzjD.raku

[19:36] <lizmat> if you're using Ints instead of int, they don't need HLLizing

[19:36] <Voldenet> I'm storing `Foo` as key and `Str` as value, so I'm assuming no HLL needed

[19:36] <lizmat> have you tried has str @!keys instead of has @!keys; ?

[19:37] <lizmat> also, return comes at an exception throwing cost

[19:38] <lizmat> in many cases in the core, I use the trick of a loop variable being incremented, and then exit when a condition is met, and then do a ternary on the value of the loop variable

[19:39] <Voldenet> m: role N[::TValue] { has TValue @!x; }; N[Int].new

[19:39] <camelia> rakudo-moar f95aefad9: OUTPUT: ¬´MoarVM panic: Memory allocation failed; could not allocate 131072 bytes‚ê§¬ª

[19:39] <Voldenet> ‚Ä¶should it do that?

[19:40] <lizmat> that feels wrong and worthy of an issue

[19:45] <Voldenet> issue issued https://github.com/rakudo/rakudo/issues/6056

[19:46] <lizmat> Voldenet++

[19:49] <Voldenet> if parametrized role was performing better, maybe resize could be implemented by storing role inside a class

[19:50] *** arkiuat joined
[19:59] *** arkiuat left
[20:12] *** arkiuat joined
[20:17] *** arkiuat left
[20:36] *** arkiuat joined
[21:05] <timo> it's infini-recursing on from src/Perl6/Metamodel/GenericHOW.nqp:24 it looks like (instantiate_generic)

[21:08] <timo> doesn't need the `N[Int].new` either, it already explodes in the parse stage when it encounters the declaration of @!x

[21:11] <timo> https://gist.github.com/timo/77a790d0f0f9e84b58d78bb56a541e0d last couple of lines of the backtrace

[21:13] <timo> committable6: releases role N[::TValue] { has TValue @!x; }; say "success";

[21:17] <committable6> timo, https://gist.github.com/168c67f4c1cc5533b231607ea183b3e5

[21:18] <timo> bisectable6: good=2023.11 bad=2023.12 role N[::TValue] { has TValue @!x; }; say "success";

[21:18] <bisectable6> timo, Bisecting by exit signal (old=2023.11 new=2023.12). Old exit signal: 0 (None)

[21:18] *** bisectable6 left
[21:22] *** bisectable6 joined
[22:39] <arkiuat> I just discovered https://github.com/Raku/raku-most-wanted but it hasn't been touched in two years, and most of the content is older than that. What's the story?

[23:22] *** Sgeo joined
[23:48] <lizmat> antononcube I don't see a draft yet for the advent post, is that correct ?

