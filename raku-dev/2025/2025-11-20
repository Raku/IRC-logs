[00:01] *** finanalyst joined
[02:29] *** nine left
[02:30] *** nine joined
[07:22] *** finanalyst left
[07:23] *** finanalyst joined
[10:08] * lizmat wonders whether we have an official way for a token mixed into a grammar to be calling the original token conditionally

[11:36] *** finanalyst left
[12:44] <timo> we don't support callsame or nextsame? if not, we probably should?

[13:39] <lizmat> first try was:   <.ident>+ | <?{ callsame }>

[13:40] <lizmat> second try was fetching the method object from the other mixin, and directly calling that

[13:42] <lizmat> the idea was to make Slang::Emoji and Slang::Nogil work together

[13:42] *** finanalyst joined
[13:42] <lizmat> so that one isn't shadowing the other

[14:14] <timo> just doing <?{ callsame }> wouldn't do it. if you're not using the return value like a regular subrule call would, it won't do what you expect i think

[14:15] <timo> how about <.ident>+ || { nextsame } ?

[14:18] *** finanalyst left
[14:23] <El_Che> timo: available?

[14:24] <El_Che> I am building locally in a opensuse leap 16.0 container and got the segfault, or at least a kill

[14:24] <El_Che> make: *** [Makefile:1377: blib/CORE.c.setting.moarvm] Killed

[14:25] <El_Che> I don't see a core file

[14:26] <El_Che> is there a way to make the compiling of "Compilingblib/CORE.c.setting.moarvm" more chatty?

[14:27] <timo> there's a few tuning knobs to enabling core dumps. the first is `ulimit -c unlimited` or `ulimit -c 0`, the other is checking and maybe changing the core pattern in /proc

[14:27] <timo> check it with `cat /proc/sys/kernel/core_pattern`

[14:28] <El_Che> |/usr/lib/systemd/systemd-coredump %P %u %g %s %t %c %h

[14:35] <El_Che> no core file present with identical config as in github actions

[14:36] <El_Che> I suspect a different consequence of the same cause

[14:38] <timo> if you have systemd-coredump, you can use coredumpctl to get it. `coredumpctl info` gives you stack traces, `coredumpctl gdb` drops you into gdb with the core dump loaded

[14:41] <El_Che> the container does not have that binary and zypper does not find it

[14:42] <El_Che> I set some debug flags and building again

[14:46] <timo> then you can just change the core_pattern to something simple like `core.%P`, check `man core` for the details

[14:47] <timo> do note that i think this is per-OS, not per-container

[15:01] <El_Che> I have seen core files in containers before

[15:01] <El_Che> anyway, too many layers here: opensuse container through podman though a podman vm in macos

[15:02] <El_Che> I will release without opensuse leap 16 for now

[15:08] <timo> if you can help me set up an equivalent container i can try it myself

[15:08] <timo> you can also install gdb in the container and run the one command that crashes with `gdb --args blablabla`, get the commands by passing --no-silent-build to the Configure.pl script

[15:10] *** melezhik joined
[15:15] <timo> oh, after you start `gdb --args blabla` you would need to `run` in the gdb shell to actually run the program, and at the end when it crashes use `taas bt` to get stack traces of all threads

[15:21] <El_Che> I will get back to you, I need to do some work stuff first

[15:31] <El_Che> cloudsmith push rpm nxadm-pkgs/rakudo-pkg/fedora/43 rakudo-pkg-Fedora43-2025.11-01.x86_64.rpm

[15:31] <El_Che> Checking rpm package upload parameters ... ERROR

[15:31] <El_Che> Failed to validate upload parameters! (status: 422 - Unprocessable Entity)

[15:31] <El_Che> lol

[15:31] <El_Che> cloudsmith everytime there is a new distro

[15:31] <El_Che> they only add them because I ping them :)

[15:57] <lizmat> timo: nextsame -> Attempt to return outside of any Routine

[16:37] <timo> did we have a sub or term that can give us the next thing we'd have tried to dispatch to, or something that we can call to resume dispatching at the next candidate? i know we have something that removes further dispatch candidates, i think "lastcall"?

[16:38] <lizmat> nextcallee ?

[16:42] <timo> ok, can you try something like `:my &thenext = nextcallee; <&thenext>`?

[16:47] <lizmat> Undeclared routine: thenext

[16:50] <lizmat> if I make it a dynamic, I get: Method Perl6::Grammar+{Emoji}+{Nogil::Legacy}.INTERPOLATE_ASSERTION not found

[17:04] *** disbot3 joined
[17:07] *** Pixi` joined
[17:08] *** disbot2 left
[17:09] *** disbot3 left
[17:09] *** disbot4 joined
[17:10] *** Pixi left
[17:10] *** lucs left
[17:12] *** lucs joined
[18:36] *** vrurg joined
[18:38] *** vrurg_ left
[20:20] *** melezhik left
[21:10] *** finanalyst joined
[23:04] <ugexe> should we merge https://github.com/rakudo/rakudo/pull/5999?

[23:05] <timo> do you think it's correct? i'm only mostly confident that i didn't make huge mistakes in there

[23:09] *** Pixi` is now known as Pixi

[23:21] <ugexe> do any of the public methods return promises now in addition to anything else they may have before?

[23:23] <timo> don't think so, no

[23:24] <ugexe> oh right, it already has a return constraint

[23:24] <ugexe> i was wondering about try-load having `return $_ if $_ := self!get-already-loaded($id.Str, :no-install);`

[23:25] <ugexe> i guess the :no-install makes it so it wont return that Promise.new

[23:25] <timo> indeed

[23:26] <ugexe> With full context reviewed, this PR is not only correct in its general concurrency fix, but carefully integrates with all expected usage and extension points for precomp loading and caching. No obvious regressions or behavioral incompatibilities are likely, given the existing Rakudo codebase. Only extremely nonstandard external consumers (not found in codebase or default ecosystem) could be

[23:26] <ugexe> subtly affected by the more elaborate value type in $loaded.

[23:26] <ugexe> ship it

[23:28] <timo> ok i'll click the button

[23:28] <Geth> ¦ rakudo/main: 4 commits pushed by (Timo Paulssen)++, timo++

[23:28] <Geth> ¦ rakudo/main: b85fb8c0c6 | Prevent issues when multiple threads try to load the same precomp

[23:28] <Geth> ¦ rakudo/main: 002dac33e2 | When precomp fails, notify waiting threads of failure

[23:28] <Geth> ¦ rakudo/main: 040d145a44 | in !load-dependencies, handle loaded hash right

[23:28] <Geth> ¦ rakudo/main: fbd475fbef | Merge pull request #5999 from rakudo/precomp_repo_no_parallel_load_of_same_precompiled_file

[23:28] <Geth> ¦ rakudo/main: review: https://github.com/rakudo/rakudo/compare/04a36dd13d33...fbd475fbefa1

