[07:15] <patrickb> any opposition to merging the vararg prs? (now is the right time)

[07:15] <patrickb> https://github.com/MoarVM/MoarVM/pull/1969

[07:15] <patrickb> https://github.com/rakudo/rakudo/pull/5998

[08:17] <Geth> ¦ nqp/main: f876d6f479 | (Elizabeth Mattijsen)++ | tools/templates/MOAR_REVISION

[08:17] <Geth> ¦ nqp/main: Bump MoarVM to get NativeCall varargs support, patrickb++

[08:17] <Geth> ¦ nqp/main: review: https://github.com/Raku/nqp/commit/f876d6f479

[08:59] <Geth> ¦ rakudo/main: 61f0918808 | (Patrick Böker)++ (committed using GitHub Web editor) | 5 files

[08:59] <Geth> ¦ rakudo/main: Add vararg support to NativeCall (#5998)

[08:59] <Geth> ¦ rakudo/main: 

[08:59] <Geth> ¦ rakudo/main: This depends on MoarVM PR #1969.

[08:59] <Geth> ¦ rakudo/main: Variadic calls are modelled via a slurpy arg. Pointers are passed via the

[08:59] <Geth> ¦ rakudo/main: `Pointer.to()` method. The C type of the values is determined by looking

[08:59] <Geth> ¦ rakudo/main: at the values themselves.

[08:59] <Geth> ¦ rakudo/main: review: https://github.com/rakudo/rakudo/commit/61f0918808

[09:01] <lizmat> grrr....

[09:04] <lizmat> looks like all of NativeCall is now broken  :-(

[09:04] <lizmat> patrickb ^^

[09:04] <lizmat> MVMArray: Index out of bounds

[09:05] <lizmat> m: use nqp; nqp::atpos(nqp::list,-1    # basically this

[09:05] <camelia> rakudo-moar 2d4a8c837: OUTPUT: «===SORRY!=== Error while compiling <tmp>␤Unable to parse expression in argument list; couldn't find final ')' (corresponding starter was at line 1)␤at <tmp>:1␤------> ::atpos(nqp::list,-1    # basically this<HERE><EOL>␤»

[09:05] <lizmat> m: use nqp; nqp::atpos(nqp::list,-1)    # basically this

[09:05] <camelia> rakudo-moar 2d4a8c837: OUTPUT: «MVMArray: Index out of bounds␤  in block <unit> at <tmp> line 1␤␤»

[09:20] <Geth> ¦ rakudo/main: 488783a7d8 | (Elizabeth Mattijsen)++ | tools/templates/NQP_REVISION

[09:20] <Geth> ¦ rakudo/main: Bump NQP to get NativeCall varargs support, patrickb++

[09:20] <Geth> ¦ rakudo/main: review: https://github.com/rakudo/rakudo/commit/488783a7d8

[09:25] <Geth> ¦ rakudo/main: f4cb406bae | (Elizabeth Mattijsen)++ | lib/NativeCall.rakumod

[09:25] <Geth> ¦ rakudo/main: Only check varargs logic if there are any args at all

[09:25] <Geth> ¦ rakudo/main: 

[09:25] <Geth> ¦ rakudo/main: Otherwise an MVMArray: Index out of bounds error will occur in that

[09:25] <Geth> ¦ rakudo/main: case.

[09:25] <Geth> ¦ rakudo/main: review: https://github.com/rakudo/rakudo/commit/f4cb406bae

[09:25] <lizmat> ok, that was easy enough to check

[09:25] <lizmat> and fix

[09:52] *** librasteve_ joined
[10:57] <Geth> ¦ rakudo/main: eb8c9b138a | (Elizabeth Mattijsen)++ | src/Raku/Actions.nqp

[10:57] <Geth> ¦ rakudo/main: Revert "RakuAST: don't allow &( ) contextualizer"

[10:57] <Geth> ¦ rakudo/main: 

[10:57] <Geth> ¦ rakudo/main: It looks like the contextualizer logic is also called for syntax

[10:57] <Geth> ¦ rakudo/main: constructs such as ".&{ 3 }".  More checks are needed.  So revert

[10:57] <Geth> ¦ rakudo/main: for now.

[10:57] <Geth> ¦ rakudo/main: 

[10:57] <Geth> ¦ rakudo/main: This reverts commit dd78e653d5925e00e0604fddd46ee9d8b9f28977.

[10:57] <Geth> ¦ rakudo/main: review: https://github.com/rakudo/rakudo/commit/eb8c9b138a

[11:11] <Geth> ¦ roast: 37bd55c86a | (Elizabeth Mattijsen)++ | S32-exceptions/misc2.t

[11:11] <Geth> ¦ roast: Make test for $] less Perl centric

[11:12] <Geth> ¦ roast: 

[11:12] <Geth> ¦ roast: In RakuAST this causes an "unexpected closing bracket" error, which

[11:12] <Geth> ¦ roast: makes *way* more sense for "say $]" for anybody who is not a die-hard

[11:12] <Geth> ¦ roast: Perl 4 programmer.

[11:12] <Geth> ¦ roast: 

[11:12] <Geth> ¦ roast: Also, in RakuAST, this is legal:

[11:12] <Geth> ¦ roast: 

[11:12] <Geth> ¦ roast:     my @a; say @a[++$];  # using anonymous state variable

[11:12] <Geth> ¦ roast: review: https://github.com/Raku/roast/commit/37bd55c86a

[11:14] <Geth> ¦ roast: 99806613ef | (Elizabeth Mattijsen)++ | 2 files

[11:14] <Geth> ¦ roast: Lose some superfluous "use v6"

[11:14] <Geth> ¦ roast: review: https://github.com/Raku/roast/commit/99806613ef

[11:40] <Geth> ¦ rakudo/main: 41a1b3cd19 | (Elizabeth Mattijsen)++ | 3 files

[11:40] <Geth> ¦ rakudo/main: RakuAST: allow ≔ as a unicode alternative for :=

[11:40] <Geth> ¦ rakudo/main: review: https://github.com/rakudo/rakudo/commit/41a1b3cd19

[11:49] <lizmat> m: 42.${ 3 }    # wow, that's an ancient error

[11:49] <camelia> rakudo-moar eb8c9b138: OUTPUT: «===SORRY!=== Error while compiling <tmp>␤Unsupported use of ${ 3 }. In Raku please use: $( 3 ) for hard ref or␤$::( 3 ) for symbolic ref.␤at <tmp>:1␤------> 42.${ 3 }<HERE>    # wow, that's an ancient error␤»

[11:49] <lizmat> hard ref ?   symbolic ref ?

[11:50] <lizmat> m: $::( 3 )

[11:50] <camelia> rakudo-moar eb8c9b138: OUTPUT: «No such symbol ''␤  in block <unit> at <tmp> line 1␤␤»

[11:51] <ab5tract> back before we had enough letters around to fully type out a word like 'reference' :)

[11:51] <ab5tract> m: role R {}; role S does R {}; use nqp; dd nqp::istype(role T does S {}, R)

[11:51] <camelia> rakudo-moar eb8c9b138: OUTPUT: «0␤»

[11:51] <ab5tract> m: role R {}; role S does R {}; use nqp; dd nqp::istype(role T does S {}.HOW.compose(T), R)

[11:51] <camelia> rakudo-moar eb8c9b138: OUTPUT: «1␤»

[11:51] <lizmat> m: Q|$::( 3 )|.AST.EVAL

[11:51] <camelia> rakudo-moar eb8c9b138: OUTPUT: «===SORRY!=== Error while compiling /home/camelia/EVAL_0␤Variable '$3' is not declared. Perhaps you forgot a 'sub' if this was␤intended to be part of a signature?␤at /home/camelia/EVAL_0:1␤------> <BOL><HERE>$::( 3 )␤»

[11:51] <lizmat> that feels more sane

[11:55] <ab5tract> re: the above role stuff -- how can this be possible? compose is called in PRODUCE-META-OBJECT

[11:56] <ab5tract> is there a (global?) hierarchy table that isn't being updated or something?

[11:56] <ab5tract> m: Q| role R {}; role S does R {}; use nqp; dd nqp::istype(role T does S {}.HOW.compose(T), R) |.AST.EVAL

[11:56] <camelia> rakudo-moar 41a1b3cd1: OUTPUT: «1␤»

[11:56] <ab5tract> m: Q| role R {}; role S does R {}; use nqp; dd nqp::istype(role T does S {}, R) |.AST.EVAL

[11:56] <camelia> rakudo-moar 41a1b3cd1: OUTPUT: «0␤»

[11:57] <lizmat> well, there *is* a type cache that nqp::istype uses

[11:58] <lizmat> nqp::settypecache

[11:59] <lizmat> appears to be called in .publish_type_cache in several metamodel classes

[12:01] <ab5tract> hm, but ParametricRoleHOW calls nqp::settypecache in its compose

[12:01] <ab5tract> :/

[12:03] <ab5tract> oops, sorry that was NQPParametriceRoleHOW

[12:24] <patrickb> lizmat: Thanks for finding and fixing my PR!

[12:26] *** ds7832 joined
[12:38] *** ds7832 left
[13:03] <lizmat> patrickb: yw

[14:22] *** librasteve_ left
[14:32] <timo> is there a way to put adverbs on the module when using `try require ::("Foo");` syntax?

[14:32] <timo> meaning auth, ver, and api

[14:48] <lizmat> not to my knowledge

[14:49] <lizmat> I usually do "use foo:ver<1.2.3>".EVAL

[14:49] <timo> that's not so cool :)

[15:03] <timo> i'm not sure how to properly work with something i pulled in with `try require Bla::Bla::Bla`, I can get as far as `say Bla::Bla::Bla` giving me a ModuleHow, and `Bla::Bla::Bla::<EXPORT>` giving me a PackageHOW. But after that, how do i correctly get at the things? the only thing I could find was to go `Bla::Bla::Bla::<EXPORT>.WHO<ALL>.WHO<TheThingIWanted>`

[15:42] <lizmat> atm I haz no idea, maybe ugexe nine have

[15:49] <ugexe> you cannot use adverbs with require at all

[15:49] <ugexe> which yes is a problem

[15:50] <ugexe> m: require Test:ver<asdfkjasldfjasdfasf>;

[15:50] <camelia> rakudo-moar 41a1b3cd1: ( no output )

[15:56] <timo> not surprised that ugexe already knows about this :)

[15:56] <[Coke]> m: require Test:ver<asdfkjasldfjasdfasf>; flunk('oh no')

[15:56] <camelia> rakudo-moar 41a1b3cd1: OUTPUT: «===SORRY!=== Error while compiling <tmp>␤Undeclared routine:␤    flunk used at line 1. Did you mean 'link'?␤␤»

[15:56] <[Coke]> (just checking which way that was failing)

[16:20] <ugexe> you'd have to export flunk

[16:21] <ugexe> m: require Test:ver<asdfasdf> <&flunk>; flunk("asfd")

[16:21] <camelia> rakudo-moar 41a1b3cd1: OUTPUT: «not ok 1 - asfd␤# Failed test 'asfd'␤# at <tmp> line 1␤»

[19:59] *** ds7832 joined
[22:27] *** [Coke] left
