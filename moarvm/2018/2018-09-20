[00:06] *** ggoebel_ left
[00:13] *** adium13 joined
[00:13] *** adium13 left
[00:19] *** nbg9 joined
[00:19] *** nbg9 left
[00:19] *** lizmat left
[00:23] *** lizmat joined
[00:24] *** p6bannerbot sets mode: +v lizmat

[00:28] *** lizmat left
[00:45] *** Kaiepi left
[00:57] *** ggoebel_ joined
[00:58] *** p6bannerbot sets mode: +v ggoebel_

[01:00] *** mst left
[01:00] *** moritz left
[01:00] *** nwc10 left
[01:00] *** krunen left
[01:00] *** krunen joined
[01:00] *** moritz joined
[01:00] *** mst joined
[01:00] *** p6bannerbot sets mode: +v mst

[01:01] *** nwc10 joined
[01:01] *** mst left
[01:01] *** mst joined
[01:01] *** livingstone.freenode.net sets mode: +v mst

[01:01] *** p6bannerbot sets mode: +v mst

[01:01] *** p6bannerbot sets mode: +v krunen

[01:01] *** ChanServ sets mode: +o mst

[01:01] *** p6bannerbot sets mode: +v moritz

[01:02] *** p6bannerbot sets mode: +v nwc10

[01:04] *** sjms18 joined
[01:05] *** sjms18 left
[01:21] *** zakharyas joined
[01:22] *** p6bannerbot sets mode: +v zakharyas

[01:32] *** MasterDuke left
[06:17] *** robertle joined
[06:18] *** p6bannerbot sets mode: +v robertle

[06:24] *** patrickb joined
[06:24] *** p6bannerbot sets mode: +v patrickb

[06:38] *** robertle left
[07:20] *** domidumont joined
[07:21] *** p6bannerbot sets mode: +v domidumont

[07:26] *** lizmat joined
[07:27] *** p6bannerbot sets mode: +v lizmat

[09:29] *** Belial` joined
[09:29] *** Belial` left
[09:30] *** qyliss1 joined
[09:30] *** qyliss1 left
[09:54] *** nebuchadnezzar left
[09:54] *** nebuchadnezzar joined
[09:55] *** p6bannerbot sets mode: +v nebuchadnezzar

[10:01] *** zakharyas left
[10:16] *** [KS] joined
[10:16] *** [KS] left
[11:06] *** avar left
[11:06] *** avar joined
[11:06] *** avar left
[11:06] *** avar joined
[11:06] *** p6bannerbot sets mode: +v avar

[11:07] *** p6bannerbot sets mode: +v avar

[11:38] *** obfusk5 joined
[11:38] *** obfusk5 left
[11:39] *** TotallyNotKim8 joined
[11:40] *** TotallyNotKim8 left
[11:53] *** trittweiler3 joined
[11:53] *** trittweiler3 left
[13:11] *** buggable left
[13:12] *** buggable joined
[13:12] *** p6bannerbot sets mode: +v buggable

[13:13] <dogbert2> jnthn: are you around?

[13:15] <dogbert2> the DU chain errors you fixed the other day are present in master in will go out with 2018.09. Is that a problem?

[13:15] *** zakharyas joined
[13:15] <dogbert2> *and will go out

[13:16] *** p6bannerbot sets mode: +v zakharyas

[13:27] <jnthn> dogbert2: I don't think so. One resulted in an instruction not being deleted (so harmless), the other broke SSA form but was still writing correct values to correct places.

[13:27] *** AquaL1te5 joined
[13:27] *** AquaL1te5 left
[13:43] *** robertle joined
[13:44] *** p6bannerbot sets mode: +v robertle

[13:54] <dogbert2> jnthn: thx

[14:00] *** lizmat left
[14:14] *** lizmat joined
[14:15] *** p6bannerbot sets mode: +v lizmat

[14:15] *** kees24 joined
[14:15] *** kees24 left
[14:36] *** zakharyas left
[14:40] *** lizmat left
[14:44] *** lizmat joined
[14:45] *** p6bannerbot sets mode: +v lizmat

[14:58] *** lizmat_ joined
[14:59] *** p6bannerbot sets mode: +v lizmat_

[15:02] *** lizmat left
[15:13] *** lizmat_ left
[15:15] *** lizmat joined
[15:15] *** p6bannerbot sets mode: +v lizmat

[15:15] *** robertle left
[15:29] *** lizmat left
[15:32] *** patrickb left
[15:37] *** committable6 left
[15:37] *** notable6 left
[15:39] *** shareable6 left
[15:39] *** unicodable6 left
[15:39] *** squashable6 left
[15:39] *** releasable6 left
[15:46] *** bisectable6 left
[15:46] *** domidumont left
[15:48] *** robertle joined
[15:49] *** p6bannerbot sets mode: +v robertle

[15:52] *** MoziM28 joined
[15:53] *** MoziM28 left
[15:56] *** jpa-14 joined
[15:56] *** jpa-14 left
[16:20] *** lizmat joined
[16:21] *** p6bannerbot sets mode: +v lizmat

[16:45] *** cHawk14 joined
[16:45] *** cHawk14 left
[16:49] *** lizmat left
[16:52] *** notable6 joined
[16:52] *** statisfiable6 joined
[16:53] *** unicodable6 joined
[16:53] *** lizmat joined
[16:53] *** p6bannerbot sets mode: +v notable6

[16:53] *** p6bannerbot sets mode: +v statisfiable6

[16:53] *** p6bannerbot sets mode: +v unicodable6

[16:54] *** p6bannerbot sets mode: +v lizmat

[16:54] *** lizmat left
[17:06] *** nativecallable6 joined
[17:06] *** shareable6 joined
[17:06] *** p6bannerbot sets mode: +v nativecallable6

[17:07] *** p6bannerbot sets mode: +v shareable6

[17:48] *** committable6 joined
[17:49] *** bisectable6 joined
[17:49] *** p6bannerbot sets mode: +v committable6

[17:49] *** rhcp12 joined
[17:49] *** rhcp12 left
[17:50] *** p6bannerbot sets mode: +v bisectable6

[17:50] *** releasable6 joined
[17:51] *** p6bannerbot sets mode: +v releasable6

[17:55] *** squashable6 joined
[17:56] *** p6bannerbot sets mode: +v squashable6

[18:18] *** fatalbit8 joined
[18:18] *** fatalbit8 left
[18:36] *** lizmat joined
[18:37] *** p6bannerbot sets mode: +v lizmat

[18:39] *** domidumont joined
[18:40] *** domidumont left
[18:42] *** domidumont joined
[18:43] *** p6bannerbot sets mode: +v domidumont

[18:51] *** domidumont left
[18:54] *** lizmat left
[19:38] *** nzhuk98_ joined
[19:38] *** nzhuk98_ left
[19:44] *** buggable left
[19:44] *** buggable joined
[19:45] *** p6bannerbot sets mode: +v buggable

[19:56] *** dogbert17 joined
[19:56] *** p6bannerbot sets mode: +v dogbert17

[19:58] <dogbert17> what does the following error message mean?

[19:58] <dogbert17> Unhandled exception: getlexref_*: outer index out of range

[19:58] <dogbert17>    at SETTING::src/core/IO/Socket/Async.pm6:170  (/home/dogbert/.rakudobrew/moar-master/install/share/perl6/runtime/CORE.setting.moarvm:connect)

[20:02] *** robertle left
[20:38] *** nekosune19 joined
[20:38] *** nekosune19 left
[20:41] <jnthn> dogbert17: "Something went rather wrong"

[20:41] <jnthn> dogbert17: I...really can't guess what

[20:49] *** TC018 joined
[20:49] *** TC018 left
[21:06] *** Kuun-Lann4 joined
[21:06] *** Kuun-Lann4 left
[21:14] *** charims22 joined
[21:14] *** charims22 left
[21:32] <timotimo> oh, hm

[21:32] <timotimo> nope, not hm after all!

[21:33] <timotimo> i'll now look into removing prof_allocated for arg_* and invoke_* ops being replaced by set ops

[21:51] <timotimo> the DU chain checker is barking at me on master, is that known? for the core setting compile

[21:54] <jnthn> Yeah, probably fixed in postrelease-opts

[21:54] <jnthn> I know it's clean in there, at least :)

[21:54] <timotimo> hah. i should probably base my work on that branch, then

[21:57] *** mneptok1 joined
[21:57] *** mneptok1 left
[22:02] <timotimo> MoarVM oops: Spesh: instruction prof_allocated missing from define-use chain

[22:02] <timotimo> well, that's at least something

[22:04] <jnthn> That one's on you :P

[22:05] <jnthn> Hm, thinking about it...I didn't audit the profiler when I did the DU chain changes, I don't think

[22:08] <timotimo> MoarVM oops: Malformed DU chain: reader prof_allocated of 3(5) in BB 8 missing

[22:08] <timotimo>       PHI               r3(5),  r3(19)

[22:08] <timotimo>       prof_allocated    r3(5)

[22:08] <timotimo> that looks like your change for returning

[22:08] <timotimo> to support umltiple returns properly

[22:09] <jnthn> Well, the fix I did was to correct a malformed DU chain

[22:09] <timotimo> hah

[22:10] <jnthn> It makes the PHI the original register that the invoke came back from

[22:10] <jnthn> Uh, invoke put the return value into

[22:10] <jnthn> So if the prof_allocated used r3(5) before it should be alright

[22:12] <timotimo> it's the same before and after the optimization pass i believe

[22:14] <timotimo> well, since i was going to remove that one anyway, maybe i'll adapt that to the new "return has a phi now" code

[22:15] <jnthn> I'm am quite curious how this broke things

[22:15] <timotimo> oh i have an idea

[22:16] <timotimo> hum. i think i used return_bb when i should have used invoke_bb

[22:17] <timotimo> but the error is still the same

[22:23] <timotimo> oh, i think i see what's up

[22:24] <timotimo> i'm trying to delete the user, but i don't know its BB

[22:24] <timotimo> in bb 32 (0x7fffec2f5d28) killing allocated logger of ins set for operand r14(15)

[22:24] <timotimo> maybe i used return_bb where i should have used inMoarVM oops: Malformed DU chain: reader prof_allocated of 14(15) in BB 33 (0x7fffec2f5d88) missing

[22:26] <timotimo> is there API for "give me the BB that has this ins in it"?

[22:27] <jnthn> No

[22:27] <jnthn> And it'd be linear search

[22:27] <timotimo> is there a reason not to have that?

[22:27] <timotimo> yes, it would

[22:27] <jnthn> So it's not really encouraged

[22:27] <jnthn> Everywhere we need the two we carry them around together

[22:28] <timotimo> am i allowed to add the bb of an ins to the MVMSpeshUsageChainEntry?

[22:28] *** lizmat joined
[22:28] <jnthn> No, because BB merging will invalidate it

[22:28] <timotimo> then spesh optimize will have to see the prof_allocated and figure out that it can't be from something that allocates any more

[22:29] *** p6bannerbot sets mode: +v lizmat

[22:29] <timotimo> though more likely it'd go through things that wrote to relevant registers and see if perhaps it got logged already

[22:29] <jnthn> What phase do you do this in?

[22:29] <jnthn> Could it be suitable to do in the post_inline phase?

[22:29] <timotimo> at the moment it's happening right as we rewrite_args and rewrite_returns

[22:31] <jnthn> Is it being kicked out for efficiency reasons?

[22:31] <jnthn> Or correctness?

[22:32] <timotimo> efficiency

[22:32] <timotimo> for that, i'd say the args rewrites are more important

[22:32] <timotimo> because then identity should finally become just prof_enterinline, prof_leave

[22:33] <timotimo> i'll leave the return-allocate-logger-opt out for the moment, then

[22:34] <timotimo> MoarVM oops: Spesh: instruction box_i missing from define-use chain

[22:34] <timotimo> huh

[22:36] <timotimo> i wonder why there is barely any detail in this error message

[22:36] <timotimo> ah! it happens in a different place

[22:37] <timotimo> that's now in the post_inline pass for some reason?

[22:38] <timotimo> removing the allocation logging made the box_i unused and that sprung a trap?

[22:38] <jnthn> The error means that there's a box_i in the graph that's *not* in the DU chain

[22:39] <jnthn> I wonder why the error is missing the register being read by the box_i...

[22:39] <timotimo> MVM_spesh_usages_delete is giving me this, which was called via post_inline_pass, in the line that says "/* Box instruction becabe unused; delete. */"

[22:39] <jnthn> Oh!

[22:40] <jnthn> Then it's not the DU checker

[22:40] <timotimo> "becabe" m)

[22:40] <timotimo> yes, that's right

[22:40] <jnthn> But the C stack tells exactly where, as you found :)

[22:40] <timotimo> the only user in that chain was a PHI node

[22:41] *** mauved15 joined
[22:41] *** mauved15 left
[23:00] <mst> timotimo: e.g. here

[23:02] *** MasterDuke joined
[23:02] *** p6bannerbot sets mode: +v MasterDuke

[23:03] *** MasterDuke left
[23:03] *** MasterDuke joined
[23:03] *** herbert.freenode.net sets mode: +v MasterDuke

[23:03] *** p6bannerbot sets mode: +v MasterDuke

[23:04] *** leont joined
[23:05] *** p6bannerbot sets mode: +v leont

[23:10] <timotimo> rr shall help me.

[23:32] *** leont left
