[00:17] *** kjp left
[00:52] <ShimmerFairy> timo: The "A\c[ZWJ]ðŸ§€" string is in fact incorrect. ZWJ only joins an existing grapheme cluster unconditionally, it doesn't necessarily extend further. Only rules GB9c (thanks to InCB=Extend) and GB11 allow a ZWJ to be followed by some otherwise non-combining character.

[00:53] <ShimmerFairy> The issue is that current MoarVM handles rule GB11 by only checking for a preceding ZWJ and following Extended_Pictographic, which isn't enough. Rule GB11 requires you to look back further to find a string of Extend-type codes following another Extended_Pictographic.

[01:29] <ShimmerFairy> As for the breaking function, what I wrote (most of) yesterday is essentially just the old function, but with 'MVMCodepoint a' replaced with state kept in the normalizer. However, by the end of yesterday I couldn't escape the feeling that this was fundamentally the wrong approach now, so I'm going to try something else first.

[01:30] <ShimmerFairy> Regardless of the solution, the concat check task you mentioned definitely can't use the same function as the normalization task anymore, they just require different behaviors with the current grapheme rules.

[03:36] *** Voldenet_ joined
[03:36] *** vrurg joined
[03:36] *** nativecallable6 left
[03:37] *** vrurg_ left
[03:37] *** Voldenet left
[03:37] *** JRaspass left
[03:37] *** Voldenet_ is now known as Voldenet

[03:39] *** nativecallable6 joined
[03:41] *** Voldenet_ joined
[03:42] *** Voldenet left
[03:42] *** Voldenet_ is now known as Voldenet

[03:43] *** nativecallable6 left
[03:44] *** nativecallable6 joined
[03:49] *** JRaspass joined
[03:49] *** nativecallable6 left
[03:49] *** nativecallable6 joined
[10:14] *** committable6 left
[10:15] *** committable6 joined
[10:42] <timo> thanks for the explanation, that's something i had missed before

[11:14] *** woodi joined
[11:15] *** woodi left
[16:36] <ShimmerFairy> Good news: I got grapheme parsing working, at least for the test strings "A\c[ZWJ]ðŸ§€" (2 graphemes)  and "ð‘©ðª„ê ‚à¥á‚Ž" (1 grapheme, InCB test)! Bad news: rakudo doesn't build. I managed to narrow the issue down to seemingly concating strings with certain characters in front. (Which shows up as hanging on parsing the > in "prefix:sym<++âš›>" in the Perl6 grammar.)

[16:39] <ShimmerFairy> I'll have to try fixing it tomorrow, but it's a good sign that it does function properly on easy test evals, and nqp's "make test" runs for the same roughly 19 seconds as before, so at first glance things haven't slowed horrifically.

[16:52] <japhb> ShimmerFairy++

[19:42] <librasteve_> https://rakudoweekly.blog/2025/12/01/2025-48-advent-is-here/

[21:44] *** librasteve_ left
