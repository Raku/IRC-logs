[01:59] *** librasteve_ left
[02:01] <Geth> ¦ Terminal-Widgets/main: 3e51cd0fe4 | (Geoffrey Broadwell)++ | examples/dir-tree.raku

[02:01] <Geth> ¦ Terminal-Widgets/main: You know what makes log scrolling faster?

[02:01] <Geth> ¦ Terminal-Widgets/main: 

[02:01] <Geth> ¦ Terminal-Widgets/main: Using the log viewer like you're supposed to, instead of breaking every

[02:01] <Geth> ¦ Terminal-Widgets/main: log entry into a dozen smaller log entries.

[02:01] <Geth> ¦ Terminal-Widgets/main: review: https://github.com/japhb/Terminal-Widgets/commit/3e51cd0fe4

[06:57] <Geth> ¦ Terminal-Widgets/main: 9 commits pushed by (Geoffrey Broadwell)++

[06:57] <Geth> ¦ Terminal-Widgets/main: 7d8f563974 | Add skip table to cap cost of Log.span-line-chunk

[06:57] <Geth> ¦ Terminal-Widgets/main: ece1fa3a9a | Protect against gaps in skip table

[06:57] <Geth> ¦ Terminal-Widgets/main: f53733b749 | Micro-optimize LogEntry content type search

[06:57] <Geth> ¦ Terminal-Widgets/main: 4ef8d74047 | Micro-optimize attribute lookup in TextContent

[06:57] <Geth> ¦ Terminal-Widgets/main: 935f8f0ea3 | Caught a thinko bug that had previously been silent

[06:57] <Geth> ¦ Terminal-Widgets/main: e8b6c2ac9d | Nerf away gather/take/LAST in SpanTree.lines

[06:57] <Geth> ¦ Terminal-Widgets/main: e556763ac4 | Don't merge-attributes unless needed in SpanTree.flatten

[06:57] <Geth> ¦ Terminal-Widgets/main: cf9ccb0a3a | Micro-optimize ScrollBars by reducing method calls

[06:57] <Geth> ¦ Terminal-Widgets/main: 0646b7f982 | Add timing debug note to Viewer::Log.add-entry

[06:57] <Geth> ¦ Terminal-Widgets/main: review: https://github.com/japhb/Terminal-Widgets/compare/3e51cd0fe40d...0646b7f9823f

[07:47] <patrickb> Curious as I've not tackled these types of problems before. Is the typical fix for event pile up to simply speed things up? (That's obviously a good improvement in any case.) Intuitively I would have tried to skip redraws whenever I notice that the event queue gets longer than 1. Would that be a stupid idea?

[09:22] <lizmat> fwiw, that's the approach I used in a "full screen" editor that I wrote in the late 80s for a customer, that was supposed to be as responsive on 286s as well as on 386s at the time

[10:10] *** librasteve_ joined
[17:38] <japhb> Right now I don't have any visibility into the length of the event queue, though I will probably have to face that when I enable mouse dragging for scroll bars; there's no way I'm going to be able to refresh-for-scroll faster than a modern terminal can throw mouse events.

[17:38] <japhb> And no, it's not really a fix to speed things up.  It *is* a good opportunity to look for stupid slowness, however.

[17:41] <japhb> For example, the skip table keeps the cost to redraw a scrolled log bounded; previously it was linear in the log length, and thus as the log got longer it would get progressively slower, making the event pile up problem worse as time went on.

[17:43] <japhb> gather/take and phasers in inner loops cost performance, and are easy enough to replace (though yes, a bit uglier now)

[17:44] <japhb> So I suppose you can consider last night to be clearing out some technical debt.  :-)

[17:45] <japhb> The other side effect of all that tweaking is that overall performance got more stable (fewer outliers, tighter distribution), which is nice for giving people a steadier, less janky experience.

[17:45] <japhb> (Research a while back showed that people are more annoyed by jank in something that's normally fast than general slowness always.)

[19:56] *** librasteve_ left
